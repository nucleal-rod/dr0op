<!DOCTYPE html>
<html lang="zh-cn">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>圆形树</title>
    <script src='../../build/image2D.js'></script>
    <script src="../_datas/program.json.js"></script>
</head>

<body>
    <script>

        var painter = $$('<canvas>非常抱歉，您的浏览器不支持canvas!</canvas>')
            // 设置画布大小
            .attr({
                "width": 700,
                "height": 700
            })
            // 画布添加到页面
            .prependTo('body')
            // 获取画笔
            .painter();

        // 树图使用布局计算结点坐标
        var layout = $$.treeLayout({

            // 数据格式配置（必须的，基本配置）
            "root": function (initTree) {
                return initTree
            },
            "id": function (treedata) {
                return treedata.name;
            },
            "child": function (parentTree, initTree) {
                return parentTree.children;
            }
        }).config({

            // 配置具体的类型（可以不配置）
            "type": "circle",
            "cx": 350,
            "cy": 350,
            "radius": 300,
            "begin-deg": 0,
            "deg": Math.PI * 2
        })

            // 设置绘图方法
            .drawer(function (tree) {

                var key, item, pitem;
                for (key in tree.node) {
                    item = tree.node[key];

                    // 画结点
                    painter
                        .config({
                            "fillStyle": "#fff",
                            "strokeStyle": "red"
                        })
                        .strokeCircle(item.left, item.top, 2)
                        .fillCircle(item.left, item.top, 2);

                    // 如果不是根结点
                    if (item.id !== tree.root) {

                        // 画连线
                        pitem = tree.node[item.pid];
                        painter
                            .config("strokeStyle", "#aaa")
                            .beginPath()
                            .moveTo(item.left, item.top)
                            .lineTo(pitem.left, pitem.top)
                            .stroke();
                    }
                }

            });

        // 启动布局
        layout(program.data);

    </script>
</body>

</html>
